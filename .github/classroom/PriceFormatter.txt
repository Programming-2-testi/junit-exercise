cGFja2FnZSBwcmljZS5mb3JtYXR0ZXI7CgppbXBvcnQgamF2YS50ZXh0Lk51bWJlckZvcm1hdDsK
aW1wb3J0IGphdmEudXRpbC5Mb2NhbGU7CgpwdWJsaWMgY2xhc3MgUHJpY2VGb3JtYXR0ZXIgewoK
ICAgIC8qKgogICAgICogRm9ybWF0IHRoZSBwcmljZSB0byBhIHN0cmluZyB3aXRoIHRoZSBmb2xs
b3dpbmcgZm9ybWF0OiAxMjMgNDU2LDc4IOKCrC4KICAgICAqCiAgICAgKiBBIHNwYWNlIGlzIHVz
ZWQgYXMgdGhvdXNhbmQgc2VwYXJhdG9yIGFuZCBhIGNvbW1hIGFzIGRlY2ltYWwgc2VwYXJhdG9y
LgogICAgICogVGhlIGRlY2ltYWwgcGFydCBtdXN0IGJlIHJvdW5kZWQgdG8gdHdvIGRpZ2l0cywg
dW5sZXNzIHRoZSBkZWNpbWFsIHBhcnQgaXMgMCwKICAgICAqIGluIHdoaWNoIGNhc2UgaXQgaXMg
b21pdHRlZC4gVGhlIGN1cnJlbmN5IHN5bWJvbCDigqwgaXMgYWRkZWQgYXQgdGhlIGVuZCBvZiB0
aGUKICAgICAqIHN0cmluZy4KICAgICAqCiAgICAgKiBAcGFyYW0gcHJpY2UgdGhlIHByaWNlIHRv
IGZvcm1hdCwgYXMgYSBkb3VibGUKICAgICAqIEByZXR1cm4gdGhlIGZvcm1hdHRlZCBwcmljZSBh
cyBhIHN0cmluZwogICAgICovCiAgICBwdWJsaWMgU3RyaW5nIGZvcm1hdFByaWNlKGRvdWJsZSBw
cmljZSkgewogICAgICAgIFN0cmluZyBidWcgPSBTeXN0ZW0uZ2V0ZW52KCkuZ2V0T3JEZWZhdWx0
KCJCVUciLCAiIik7CgogICAgICAgIHN3aXRjaCAoYnVnKSB7CiAgICAgICAgICAgIGNhc2UgInRv
b01hbnlEZWNpbWFsUGxhY2VzIjoKICAgICAgICAgICAgICAgIHJldHVybiB0b29NYW55RGVjaW1h
bFBsYWNlcyhwcmljZSk7CiAgICAgICAgICAgIGNhc2UgImRvdFVzZWRBc1Rob3VzYW5kU2VwYXJh
dG9yIjoKICAgICAgICAgICAgICAgIHJldHVybiBkb3RVc2VkQXNUaG91c2FuZFNlcGFyYXRvcihw
cmljZSk7CiAgICAgICAgICAgIGNhc2UgInplcm9Ob3RPbWl0dGVkSW5EZWNpbWFscyI6CiAgICAg
ICAgICAgICAgICByZXR1cm4gemVyb05vdE9taXR0ZWRJbkRlY2ltYWxzKHByaWNlKTsKICAgICAg
ICAgICAgY2FzZSAiZGVjaW1hbFBhcnRUb29TaG9ydCI6CiAgICAgICAgICAgICAgICByZXR1cm4g
ZGVjaW1hbFBhcnRUb29TaG9ydChwcmljZSk7CiAgICAgICAgICAgIGNhc2UgImRlY2ltYWxQYXJ0
Um91bmRlZEluY29ycmVjdGx5IjoKICAgICAgICAgICAgICAgIHJldHVybiBkZWNpbWFsUGFydFJv
dW5kZWRJbmNvcnJlY3RseShwcmljZSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gY29ycmVj
dChwcmljZSk7CiAgICB9CgogICAgcHJpdmF0ZSBTdHJpbmcgY29ycmVjdChkb3VibGUgcHJpY2Up
IHsKICAgICAgICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNTA1NDIxNwogICAgICAg
IE51bWJlckZvcm1hdCBmb3JtYXR0ZXIgPSBOdW1iZXJGb3JtYXQuZ2V0TnVtYmVySW5zdGFuY2Uo
TG9jYWxlLkdFUk1BTik7CgogICAgICAgIC8vIFRoZSBkZWNpbWFsIHBhcnQgbXVzdCBiZSByb3Vu
ZGVkIHRvIHR3byBkaWdpdHMsIHVubGVzcyB0aGUgZGVjaW1hbCBwYXJ0IGlzIDAsCiAgICAgICAg
Ly8gaW4gd2hpY2ggY2FzZSBpdCBpcyBvbWl0dGVkLgogICAgICAgIHZhciBkaWdpdHMgPSAocHJp
Y2UgJSAxICE9IDApID8gMiA6IDA7CiAgICAgICAgZm9ybWF0dGVyLnNldE1pbmltdW1GcmFjdGlv
bkRpZ2l0cyhkaWdpdHMpOwogICAgICAgIGZvcm1hdHRlci5zZXRNYXhpbXVtRnJhY3Rpb25EaWdp
dHMoZGlnaXRzKTsKCiAgICAgICAgcmV0dXJuIGZvcm1hdHRlci5mb3JtYXQocHJpY2UpLnJlcGxh
Y2UoIi4iLCAiICIpICsgIiDigqwiOwogICAgfQoKICAgIHByaXZhdGUgU3RyaW5nIHRvb01hbnlE
ZWNpbWFsUGxhY2VzKGRvdWJsZSBwcmljZSkgewogICAgICAgIE51bWJlckZvcm1hdCBmb3JtYXR0
ZXIgPSBOdW1iZXJGb3JtYXQuZ2V0TnVtYmVySW5zdGFuY2UoTG9jYWxlLkdFUk1BTik7CiAgICAg
ICAgcmV0dXJuIGZvcm1hdHRlci5mb3JtYXQocHJpY2UpLnJlcGxhY2UoIi4iLCAiICIpICsgIiDi
gqwiOwogICAgfQoKICAgIHByaXZhdGUgU3RyaW5nIGRvdFVzZWRBc1Rob3VzYW5kU2VwYXJhdG9y
KGRvdWJsZSBwcmljZSkgewogICAgICAgIE51bWJlckZvcm1hdCBmb3JtYXR0ZXIgPSBOdW1iZXJG
b3JtYXQuZ2V0TnVtYmVySW5zdGFuY2UoTG9jYWxlLkdFUk1BTik7CgogICAgICAgIHZhciBkaWdp
dHMgPSAocHJpY2UgJSAxICE9IDApID8gMiA6IDA7CiAgICAgICAgZm9ybWF0dGVyLnNldE1pbmlt
dW1GcmFjdGlvbkRpZ2l0cyhkaWdpdHMpOwogICAgICAgIGZvcm1hdHRlci5zZXRNYXhpbXVtRnJh
Y3Rpb25EaWdpdHMoZGlnaXRzKTsKCiAgICAgICAgcmV0dXJuIGZvcm1hdHRlci5mb3JtYXQocHJp
Y2UpICsgIiDigqwiOwoKICAgIH0KCiAgICBwcml2YXRlIFN0cmluZyB6ZXJvTm90T21pdHRlZElu
RGVjaW1hbHMoZG91YmxlIHByaWNlKSB7CiAgICAgICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93
LmNvbS9hLzUwNTQyMTcKICAgICAgICBOdW1iZXJGb3JtYXQgZm9ybWF0dGVyID0gTnVtYmVyRm9y
bWF0LmdldE51bWJlckluc3RhbmNlKExvY2FsZS5HRVJNQU4pOwoKICAgICAgICAvLyBUaGUgZGVj
aW1hbCBwYXJ0IG11c3QgYmUgcm91bmRlZCB0byB0d28gZGlnaXRzLCB1bmxlc3MgdGhlIGRlY2lt
YWwgcGFydCBpcyAwLAogICAgICAgIC8vIGluIHdoaWNoIGNhc2UgaXQgaXMgb21pdHRlZC4KICAg
ICAgICBmb3JtYXR0ZXIuc2V0TWluaW11bUZyYWN0aW9uRGlnaXRzKDIpOwogICAgICAgIGZvcm1h
dHRlci5zZXRNYXhpbXVtRnJhY3Rpb25EaWdpdHMoMik7CgogICAgICAgIHJldHVybiBmb3JtYXR0
ZXIuZm9ybWF0KHByaWNlKS5yZXBsYWNlKCIuIiwgIiAiKSArICIg4oKsIjsKICAgIH0KCiAgICBw
cml2YXRlIFN0cmluZyBkZWNpbWFsUGFydFRvb1Nob3J0KGRvdWJsZSBwcmljZSkgewogICAgICAg
IC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS81MDU0MjE3CiAgICAgICAgTnVtYmVyRm9y
bWF0IGZvcm1hdHRlciA9IE51bWJlckZvcm1hdC5nZXROdW1iZXJJbnN0YW5jZShMb2NhbGUuR0VS
TUFOKTsKCiAgICAgICAgLy8gVGhlIGRlY2ltYWwgcGFydCBtdXN0IGJlIHJvdW5kZWQgdG8gdHdv
IGRpZ2l0cywgdW5sZXNzIHRoZSBkZWNpbWFsIHBhcnQgaXMgMCwKICAgICAgICAvLyBpbiB3aGlj
aCBjYXNlIGl0IGlzIG9taXR0ZWQuCiAgICAgICAgdmFyIGRpZ2l0cyA9IChwcmljZSAlIDEgIT0g
MCkgPyAyIDogMDsKICAgICAgICBmb3JtYXR0ZXIuc2V0TWF4aW11bUZyYWN0aW9uRGlnaXRzKGRp
Z2l0cyk7CgogICAgICAgIHJldHVybiBmb3JtYXR0ZXIuZm9ybWF0KHByaWNlKS5yZXBsYWNlKCIu
IiwgIiAiKSArICIg4oKsIjsKICAgIH0KCiAgICBwcml2YXRlIFN0cmluZyBkZWNpbWFsUGFydFJv
dW5kZWRJbmNvcnJlY3RseShkb3VibGUgcHJpY2UpIHsKICAgICAgICAvLyBodHRwczovL3N0YWNr
b3ZlcmZsb3cuY29tL2EvNTA1NDIxNwogICAgICAgIE51bWJlckZvcm1hdCBmb3JtYXR0ZXIgPSBO
dW1iZXJGb3JtYXQuZ2V0TnVtYmVySW5zdGFuY2UoTG9jYWxlLkdFUk1BTik7CgogICAgICAgIHZh
ciBkaWdpdHMgPSAocHJpY2UgJSAxICE9IDApID8gMiA6IDA7CiAgICAgICAgZm9ybWF0dGVyLnNl
dE1pbmltdW1GcmFjdGlvbkRpZ2l0cyhkaWdpdHMpOwogICAgICAgIGZvcm1hdHRlci5zZXRNYXhp
bXVtRnJhY3Rpb25EaWdpdHMoZGlnaXRzKTsKCiAgICAgICAgLy8gdW53YW50ZWQgcm91bmRpbmcK
ICAgICAgICBmb3JtYXR0ZXIuc2V0Um91bmRpbmdNb2RlKGphdmEubWF0aC5Sb3VuZGluZ01vZGUu
RE9XTik7CgogICAgICAgIHJldHVybiBmb3JtYXR0ZXIuZm9ybWF0KHByaWNlKS5yZXBsYWNlKCIu
IiwgIiAiKSArICIg4oKsIjsKICAgIH0KfQo=
